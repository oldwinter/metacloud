#https://hub.docker.com/_/ubuntu
FROM ubuntu:20.04 

LABEL OWNER="oldwinter"

WORKDIR /home

### ğŸ‘‡ğŸ»ç”¨aptåŒ…ç®¡ç†ç³»ç»Ÿï¼Œå®‰è£…ç³»ç»Ÿçº§linuxå¸¸ç”¨å·¥å…·
# apt-get å®˜æ–¹æ–‡æ¡£ï¼š https://linux.die.net/man/8/apt-get
# net-tools: netstat ifconfig
# iputils-ping: ping
# tldr: è¿…é€ŸçŸ¥é“å¦‚ä½•ä½¿ç”¨æŸå‘½ä»¤
# speedtest: æµ‹ç½‘é€Ÿ
RUN apt-get update  \
    # å–æ¶ˆæ‰€æœ‰å®‰è£…å‘½ä»¤çš„äº¤äº’,å–æ¶ˆæ‰€æœ‰æ¨èåŒ…çš„å®‰è£…
    && DEBIAN_FRONTEND=noninteractive apt-get install -y --no-install-recommends \
    # åŒ…å«äº†ä¸€äº›æ¨¡æ¿ï¼Œå¿…è£…ï¼Œåé¢å°±ä¼šè‡ªåŠ¨ç”¨æ¨¡æ¿é…ç½®è½¯ä»¶
    apt-utils locales \
    # è‡ªåŠ¨è·³è¿‡å„ç§é€‰æ—¶åŒºçš„ç•Œé¢ï¼Œlocaleséœ€è¦å…ˆå®‰è£…
    && dpkg-reconfigure -f noninteractive locales \
    && DEBIAN_FRONTEND=noninteractive apt-get install -y --no-install-recommends \
    sudo curl git zsh \
    tree wget vim tldr \
    speedtest-cli \
    net-tools iputils-ping iptables \
    # nodejsçš„ä¸œè¥¿ç»´æŠ¤åœ¨è‡ªå·±çš„ä»“åº“é‡Œï¼Œè¿™é‡Œå®˜æ–¹è„šæœ¬è§„å®šæ­»äº†17+ç‰ˆæœ¬ï¼Œä»¥åè®°å¾—æ‰‹åŠ¨æ”¹
    && curl -fsSL https://deb.nodesource.com/setup_17.x | bash - \
    && DEBIAN_FRONTEND=noninteractive apt-get install -y --no-install-recommends  nodejs \
    # æ¸…ç†ç°åœºï¼Œç²¾ç®€é•œåƒlayer
    && apt-get -y autoclean \ 
    && rm -rf /var/lib/apt/lists/*

### ğŸ‘‡ğŸ»å®‰è£…npmå¸¸ç”¨å·¥å…·
# zx: ç”¨jså†™bashè„šæœ¬
# yarn æœ‰æ—¶å¯èƒ½ä¼šç”¨åˆ°
# http-serverï¼Œå¿«é€Ÿå¯åŠ¨ä¸€ä¸ªç®€æ˜“webserveråšæµ‹è¯•ç”¨
RUN npm i -g zx yarn http-server

### ğŸ‘‡ğŸ»å‰è€…æ˜¯å¤šä¸ªæ–‡ä»¶æ—¶ï¼Œåè€…æœ«å°¾è¦åŠ /æ‰è¡¨ç¤ºcopyæ•´ä¸ªæ–‡ä»¶å¤¹åˆ°ç›®å½•ä¸‹
COPY install-scripts/* ./install-scripts/

### ğŸ‘‡ğŸ»oh my zsh å†…ç½®äº†shellä¸»é¢˜ï¼Œz å‘½ä»¤ï¼Œè‡ªåŠ¨è¡¥å…¨å’Œå„ç§å……æ»¡æƒ³è±¡åŠ›çš„å°ä¸œè¥¿
RUN bash install-scripts/install-ohmyzsh.sh

### ğŸ‘‡ğŸ»å®‰è£…dockerçš„å‘½ä»¤è¡Œå·¥å…·ï¼Œä¸å®‰è£…daemon
# Install Docker CE CLI and docker-compose CLI ç¤¾åŒºç‰ˆçš„dockerè¿˜æ²¡å†…ç½®composeå‘½ä»¤ï¼Œè¿˜éœ€è¦é¢å¤–è£…ä¸ªdocker-compose
RUN bash install-scripts/install-docker.sh

### ğŸ‘‡ğŸ»homebrew å®˜æ–¹åªæ”¯æŒéroot ç”¨æˆ·å®‰è£…ï¼Œé€Ÿåº¦å¾ˆæ…¢ï¼Œè£…å®Œåè¶…è¿‡500MBå ç”¨ï¼Œè€ƒè™‘ä¸è£…å®ƒï¼Œè¿™é‡Œç”¨æ¸…åçš„é•œåƒç«™
# RUN bash install-scripts/install-homebrew.sh
    
VOLUME [ "/data" ]

SHELL [ "zsh" ]